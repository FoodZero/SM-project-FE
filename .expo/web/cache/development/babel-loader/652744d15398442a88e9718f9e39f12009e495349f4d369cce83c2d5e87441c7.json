{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nvar _jsxFileName = \"C:\\\\Users\\\\eleme\\\\SM-project-FE\\\\SM-project-FE-1\\\\screens\\\\Auth\\\\KakaoScreen\\\\KakaoLogin.js\",\n  _this = this;\nimport React from \"react\";\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport { WebView } from 'react-native-webview';\nimport axios from 'axios';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { useNavigation } from \"@react-navigation/native\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar REST_API_KEY = '09d652793b5af3f3b4e1587039feb0c4';\nvar REDIRECT_URI = 'http://172.30.1.85:8081/api/members/callback/kakao';\nvar INJECTED_JAVASCRIPT = `window.ReactNativeWebView.postMessage('message from webView')`;\nvar KaKaoLogin = function KaKaoLogin() {\n  var navigation = useNavigation();\n  function KakaoLoginWebView(data) {\n    var exp = \"code=\";\n    var condition = data.indexOf(exp);\n    if (condition != -1) {\n      var authorize_code = data.substring(condition + exp.length);\n      console.log(authorize_code);\n      requestToken(authorize_code);\n    }\n    ;\n  }\n  var requestToken = function () {\n    var _ref = _asyncToGenerator(function* (authorize_code) {\n      var AccessToken = \"none\";\n      axios({\n        method: 'GET',\n        url: 'http://www.sm-project-refrigerator.store/api/members/callback/kakao',\n        params: {\n          code: authorize_code\n        }\n      }).then(function (response) {\n        console.log(response);\n        AccessToken = response.data.result.accessToken;\n        if (!response.data.isSuccess) {\n          navigation.navigate(\"Signup\", {\n            screen: \"Signup\"\n          });\n        } else {\n          storeData(AccessToken);\n          console.log(\"accesstoken:\", AccessToken);\n          navigation.navigate(\"screen1\", {\n            screen: \"screen1\"\n          });\n          navigation.navigate(\"screen1\", {\n            AccessToken: AccessToken\n          });\n        }\n      }).catch(function (error) {\n        console.log('error', error);\n      });\n    });\n    return function requestToken(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  function requestUserInfo(AccessToken) {\n    axios({\n      method: 'GET',\n      url: 'https://kapi.kakao.com/v2/user/me',\n      headers: {\n        Authorization: `Bearer ${AccessToken}`\n      }\n    }).then(function (response) {\n      var user_emil = response.data.kakao_account.email;\n      var user_range = response.data.kakao_account.age_range;\n      var user_gender = response.data.kakao_account.gender;\n      console.log(\"user_emil\", user_emil);\n      console.log(\"user_range\", user_range);\n      console.log(\"user_gender\", user_gender);\n    }).catch(function (error) {\n      console.log('error', error);\n    });\n    return;\n  }\n  var storeData = function () {\n    var _ref2 = _asyncToGenerator(function* (returnValue) {\n      try {\n        yield AsyncStorage.setItem('userAccessToken', returnValue);\n      } catch (error) {}\n    });\n    return function storeData(_x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  return _jsxDEV(View, {\n    style: Styles.container,\n    children: _jsxDEV(WebView, {\n      style: {\n        flex: 1\n      },\n      originWhitelist: ['*'],\n      scalesPageToFit: false,\n      source: {\n        uri: `https://kauth.kakao.com/oauth/authorize?response_type=code&client_id=${REST_API_KEY}&redirect_uri=${REDIRECT_URI}`\n      },\n      injectedJavaScript: INJECTED_JAVASCRIPT,\n      javaScriptEnabled: true,\n      onMessage: function onMessage(event) {\n        KakaoLoginWebView(event.nativeEvent[\"url\"]);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 9\n    }, _this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 88,\n    columnNumber: 7\n  }, _this);\n};\nexport default KaKaoLogin;\nvar Styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    marginTop: 24,\n    backgroundColor: '#fff'\n  }\n});","map":{"version":3,"names":["React","View","StyleSheet","WebView","axios","AsyncStorage","useNavigation","jsxDEV","_jsxDEV","REST_API_KEY","REDIRECT_URI","INJECTED_JAVASCRIPT","KaKaoLogin","navigation","KakaoLoginWebView","data","exp","condition","indexOf","authorize_code","substring","length","console","log","requestToken","_ref","_asyncToGenerator","AccessToken","method","url","params","code","then","response","result","accessToken","isSuccess","navigate","screen","storeData","catch","error","_x","apply","arguments","requestUserInfo","headers","Authorization","user_emil","kakao_account","email","user_range","age_range","user_gender","gender","_ref2","returnValue","setItem","_x2","style","Styles","container","children","flex","originWhitelist","scalesPageToFit","source","uri","injectedJavaScript","javaScriptEnabled","onMessage","event","nativeEvent","fileName","_jsxFileName","lineNumber","columnNumber","_this","create","marginTop","backgroundColor"],"sources":["C:/Users/eleme/SM-project-FE/SM-project-FE-1/screens/Auth/KakaoScreen/KakaoLogin.js"],"sourcesContent":["\nimport React from \"react\";\nimport { View, StyleSheet } from \"react-native\";\nimport { WebView } from 'react-native-webview';\nimport axios from 'axios';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { useNavigation } from \"@react-navigation/native\";\n\nconst REST_API_KEY = '09d652793b5af3f3b4e1587039feb0c4';\nconst REDIRECT_URI = 'http://172.30.1.85:8081/api/members/callback/kakao';\nconst INJECTED_JAVASCRIPT = `window.ReactNativeWebView.postMessage('message from webView')`;\n\nconst KaKaoLogin = () => {\n\n    const navigation = useNavigation();\n  \n    function KakaoLoginWebView (data) {\n      const exp = \"code=\";\n      var condition = data.indexOf(exp);    \n      if (condition != -1) {\n        var authorize_code = data.substring(condition + exp.length);\n        console.log(authorize_code);\n        requestToken(authorize_code);\n      };\n    }\n  \n    const requestToken = async (authorize_code) => {\n      var AccessToken = \"none\";\n      axios ({\n        method: 'GET',\n        url:'http://www.sm-project-refrigerator.store/api/members/callback/kakao',\n        params: {\n       \n          code: authorize_code,\n        },\n      }).then((response) => {\n        console.log(response);\n        AccessToken = response.data.result.accessToken;\n        \n        //console.log(AccessToken);\n          //requestUserInfo(AccessToken);\n        // Check if isSuccess is false\n    if (!response.data.isSuccess) {\n      navigation.navigate(\"Signup\", { screen: \"Signup\" });\n      //회원가입화면으로 이동\n     \n      \n    } else {\n      // If isSuccess is true, proceed with storing the access token\n      storeData(AccessToken);\n      console.log(\"accesstoken:\",AccessToken);\n      navigation.navigate(\"screen1\", { screen: \"screen1\" });\n      navigation.navigate(\"screen1\", { AccessToken: AccessToken });\n    }\n  }) .catch (function (error) {\n    console.log('error', error);\n  })\n};\n  \n     function requestUserInfo(AccessToken)  {\n       axios ({\n         method: 'GET',\n         url: 'https://kapi.kakao.com/v2/user/me',\n         headers: {\n           Authorization : `Bearer ${AccessToken}`\n         },\n       }).then((response) => {\n         var user_emil = response.data.kakao_account.email;\n         var user_range = response.data.kakao_account.age_range;\n         var user_gender = response.data.kakao_account.gender;\n         console.log(\"user_emil\", user_emil);\n         console.log(\"user_range\", user_range);\n         console.log(\"user_gender\", user_gender);\n       }).catch(function (error) {\n         console.log('error', error);\n       })\n       return;\n     }\n  \n     const storeData = async (returnValue) => {\n      try {\n        await AsyncStorage.setItem('userAccessToken', returnValue);\n      } catch (error) {\n      }\n    }\n  \n    return (\n      <View style={Styles.container}>      \n        <WebView\n          style={{ flex: 1 }}\n          originWhitelist={['*']}\n          scalesPageToFit={false}\n          source={{\n            uri: `https://kauth.kakao.com/oauth/authorize?response_type=code&client_id=${REST_API_KEY}&redirect_uri=${REDIRECT_URI}`,\n          }}\n          injectedJavaScript={INJECTED_JAVASCRIPT}\n          javaScriptEnabled\n          onMessage={event => { KakaoLoginWebView(event.nativeEvent[\"url\"]); }}\n        />\n      </View>\n    )\n  }\n  \n  export default KaKaoLogin;\n  \n  const Styles = StyleSheet.create({\n    container: {\n      flex: 1,\n      marginTop: 24,\n      backgroundColor: '#fff',\n    },    \n  });"],"mappings":";;;AACA,OAAOA,KAAK,MAAM,OAAO;AAAC,OAAAC,IAAA;AAAA,OAAAC,UAAA;AAE1B,SAASC,OAAO,QAAQ,sBAAsB;AAC9C,OAAOC,KAAK,MAAM,OAAO;AACzB,OAAOC,YAAY,MAAM,2CAA2C;AACpE,SAASC,aAAa,QAAQ,0BAA0B;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEzD,IAAMC,YAAY,GAAG,kCAAkC;AACvD,IAAMC,YAAY,GAAG,oDAAoD;AACzE,IAAMC,mBAAmB,GAAG,+DAA+D;AAE3F,IAAMC,UAAU,GAAG,SAAbA,UAAUA,CAAA,EAAS;EAErB,IAAMC,UAAU,GAAGP,aAAa,CAAC,CAAC;EAElC,SAASQ,iBAAiBA,CAAEC,IAAI,EAAE;IAChC,IAAMC,GAAG,GAAG,OAAO;IACnB,IAAIC,SAAS,GAAGF,IAAI,CAACG,OAAO,CAACF,GAAG,CAAC;IACjC,IAAIC,SAAS,IAAI,CAAC,CAAC,EAAE;MACnB,IAAIE,cAAc,GAAGJ,IAAI,CAACK,SAAS,CAACH,SAAS,GAAGD,GAAG,CAACK,MAAM,CAAC;MAC3DC,OAAO,CAACC,GAAG,CAACJ,cAAc,CAAC;MAC3BK,YAAY,CAACL,cAAc,CAAC;IAC9B;IAAC;EACH;EAEA,IAAMK,YAAY;IAAA,IAAAC,IAAA,GAAAC,iBAAA,CAAG,WAAOP,cAAc,EAAK;MAC7C,IAAIQ,WAAW,GAAG,MAAM;MACxBvB,KAAK,CAAE;QACLwB,MAAM,EAAE,KAAK;QACbC,GAAG,EAAC,qEAAqE;QACzEC,MAAM,EAAE;UAENC,IAAI,EAAEZ;QACR;MACF,CAAC,CAAC,CAACa,IAAI,CAAC,UAACC,QAAQ,EAAK;QACpBX,OAAO,CAACC,GAAG,CAACU,QAAQ,CAAC;QACrBN,WAAW,GAAGM,QAAQ,CAAClB,IAAI,CAACmB,MAAM,CAACC,WAAW;QAKlD,IAAI,CAACF,QAAQ,CAAClB,IAAI,CAACqB,SAAS,EAAE;UAC5BvB,UAAU,CAACwB,QAAQ,CAAC,QAAQ,EAAE;YAAEC,MAAM,EAAE;UAAS,CAAC,CAAC;QAIrD,CAAC,MAAM;UAELC,SAAS,CAACZ,WAAW,CAAC;UACtBL,OAAO,CAACC,GAAG,CAAC,cAAc,EAACI,WAAW,CAAC;UACvCd,UAAU,CAACwB,QAAQ,CAAC,SAAS,EAAE;YAAEC,MAAM,EAAE;UAAU,CAAC,CAAC;UACrDzB,UAAU,CAACwB,QAAQ,CAAC,SAAS,EAAE;YAAEV,WAAW,EAAEA;UAAY,CAAC,CAAC;QAC9D;MACF,CAAC,CAAC,CAAEa,KAAK,CAAE,UAAUC,KAAK,EAAE;QAC1BnB,OAAO,CAACC,GAAG,CAAC,OAAO,EAAEkB,KAAK,CAAC;MAC7B,CAAC,CAAC;IACJ,CAAC;IAAA,gBA/BSjB,YAAYA,CAAAkB,EAAA;MAAA,OAAAjB,IAAA,CAAAkB,KAAA,OAAAC,SAAA;IAAA;EAAA,GA+BrB;EAEI,SAASC,eAAeA,CAAClB,WAAW,EAAG;IACrCvB,KAAK,CAAE;MACLwB,MAAM,EAAE,KAAK;MACbC,GAAG,EAAE,mCAAmC;MACxCiB,OAAO,EAAE;QACPC,aAAa,EAAG,UAAUpB,WAAW;MACvC;IACF,CAAC,CAAC,CAACK,IAAI,CAAC,UAACC,QAAQ,EAAK;MACpB,IAAIe,SAAS,GAAGf,QAAQ,CAAClB,IAAI,CAACkC,aAAa,CAACC,KAAK;MACjD,IAAIC,UAAU,GAAGlB,QAAQ,CAAClB,IAAI,CAACkC,aAAa,CAACG,SAAS;MACtD,IAAIC,WAAW,GAAGpB,QAAQ,CAAClB,IAAI,CAACkC,aAAa,CAACK,MAAM;MACpDhC,OAAO,CAACC,GAAG,CAAC,WAAW,EAAEyB,SAAS,CAAC;MACnC1B,OAAO,CAACC,GAAG,CAAC,YAAY,EAAE4B,UAAU,CAAC;MACrC7B,OAAO,CAACC,GAAG,CAAC,aAAa,EAAE8B,WAAW,CAAC;IACzC,CAAC,CAAC,CAACb,KAAK,CAAC,UAAUC,KAAK,EAAE;MACxBnB,OAAO,CAACC,GAAG,CAAC,OAAO,EAAEkB,KAAK,CAAC;IAC7B,CAAC,CAAC;IACF;EACF;EAEA,IAAMF,SAAS;IAAA,IAAAgB,KAAA,GAAA7B,iBAAA,CAAG,WAAO8B,WAAW,EAAK;MACxC,IAAI;QACF,MAAMnD,YAAY,CAACoD,OAAO,CAAC,iBAAiB,EAAED,WAAW,CAAC;MAC5D,CAAC,CAAC,OAAOf,KAAK,EAAE,CAChB;IACF,CAAC;IAAA,gBALMF,SAASA,CAAAmB,GAAA;MAAA,OAAAH,KAAA,CAAAZ,KAAA,OAAAC,SAAA;IAAA;EAAA,GAKf;EAED,OACEpC,OAAA,CAACP,IAAI;IAAC0D,KAAK,EAAEC,MAAM,CAACC,SAAU;IAAAC,QAAA,EAC5BtD,OAAA,CAACL,OAAO;MACNwD,KAAK,EAAE;QAAEI,IAAI,EAAE;MAAE,CAAE;MACnBC,eAAe,EAAE,CAAC,GAAG,CAAE;MACvBC,eAAe,EAAE,KAAM;MACvBC,MAAM,EAAE;QACNC,GAAG,EAAE,wEAAwE1D,YAAY,iBAAiBC,YAAY;MACxH,CAAE;MACF0D,kBAAkB,EAAEzD,mBAAoB;MACxC0D,iBAAiB;MACjBC,SAAS,EAAE,SAAAA,UAAAC,KAAK,EAAI;QAAEzD,iBAAiB,CAACyD,KAAK,CAACC,WAAW,CAAC,KAAK,CAAC,CAAC;MAAE;IAAE;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,GAAAC,KACtE;EAAC;IAAAJ,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,GAAAC,KACE,CAAC;AAEX,CAAC;AAED,eAAejE,UAAU;AAEzB,IAAMgD,MAAM,GAAG1D,UAAU,CAAC4E,MAAM,CAAC;EAC/BjB,SAAS,EAAE;IACTE,IAAI,EAAE,CAAC;IACPgB,SAAS,EAAE,EAAE;IACbC,eAAe,EAAE;EACnB;AACF,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}